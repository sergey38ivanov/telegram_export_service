<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Telegram Export Viewer</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #1e1e1e;
      color: #e0e0e0;
      display: flex;
      height: 100vh;
      font-size: 12px;
    }

    .panel {
      padding: 10px;
      overflow-y: auto;
      transition: width 0.3s ease;
    }

    .sidebar {
      width: 250px;
      background-color: #2c2c2c;
      border-right: 1px solid #444;
    }

    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .toolbar {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: #2a2a2a;
      border-bottom: 1px solid #444;
    }

    .section {
      padding: 10px;
      border-bottom: 1px solid #444;
    }

    .details {
      width: 370px;
      background-color: #2c2c2c;
      border-left: 1px solid #444;
    }

    .collapsed {
      width: 20px !important;
      overflow: hidden;
    }

    .toggle-btn {
      background-color: #444;
      color: #fff;
      border: none;
      padding: 5px;
      cursor: pointer;
    }

    .toggle-btn:hover {
      background-color: #666;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 5px;
    }

    table, th, td {
      border: 1px solid #444;
    }

    th, td {
      padding: 5px;
      text-align: left;
    }

    .hidden {
      display: none;
    }
    #folder-list{
      padding-inline-start: 10px;
      max-height: 200px;
      overflow-y: auto;
      overflow-x: hidden;
    }
    #folder-list li{
        cursor: pointer;
        list-style: none;
    }
    #folder-list li:hover{
        text-decoration: underline;
    }
    #statistics span{
      font-weight: bold;
    }
    /* -------------------------------- */
    #chatPhoto{
      max-width: 50%;
      height: auto;
      margin-right: 5px;
    }
    #chatPhoto img {
      max-width: 100%;
      height: auto;
    }

    #chat-details {
      display: flex;
    }
    #chat-details p{
      margin: 3px 0;
    }
    /* ------------------------------------- */
    #contacts-list ul{
      padding-left: 10px;
      overflow-y: auto;
      max-height: 250px;
    }
    #contacts-list li, #contacts li {
      list-style: none;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
    }
    #contacts-list li .photo, #contacts li .photo,
    #contacts td .photo, #chat-table td .photo {
      display: inline-block;
      width: 40px;
      min-width: 40px;
      height: 40px;
      background-color: #444;
      border-radius: 50%;
      margin-right: 10px;
    }
    #contacts th{
      text-align: center;
    }
    #contacts td:nth-child(1), #chat-table td:nth-child(1) {
      width: 40px;
      max-width: 40px;
      min-width: 40px;
    }
    #contacts td .photo, #chat-table td .photo {
      margin: 0px !important;
    }
    #contacts td .username a, #contacts-list li .username a {
      text-decoration: none;
      color: #fff !important;
      font-style: italic;
    }
    .profile-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      color: #fff;
      font-weight: bold;
      font-size: 1.2em;
    }
    #contacts-list li .name, #contacts li .name {
      font-weight: bold;
      margin-right: 10px;
    }
    #contacts-list li .phone, #contacts-list li .user-id,
    #contacts-list li .username, #contacts-list li .name{
      display: inline-block;
    }
    #contacts li .phone, #contacts li .user-id,
    #contacts li .username, #contacts li .name{
      display: inline-block;
      margin-right: 10px;
    }
    #contacts-list li .phone::before, #contacts td .phone::before {
      content: "üìû";
    }
    #contacts-list li .user-id::before, #contacts td .user-id::before {
      content: "üÜî";
    }
    #contacts-list li .username::before, #contacts td .username::before  {
      content: "üë§";
    }
    #contacts-list li>span:nth-child(2), #contacts-list li>span:nth-child(3){
      width: 45%;
      display: flex;
      flex-direction: column;
    }

    #contacts.section, #chat-table.section {
      overflow-y: auto;
      max-height: 300px !important;
    }
    #chat-table td{
      cursor: pointer;
    }
    /* ---------------------------- */
    #chat-list.section{
      padding-right: 0px !important;
    }
    #chat-list ul{
      padding-left: 0px;
      overflow-y: auto;
      max-height: 270px;
    }
    #chat-list li {
      list-style: none;
      margin-bottom: 5px;
      margin-right: 5px;
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    #chat-list li:hover {
      background-color: #000;
    }
    #chat-list li .photo {
      display: inline-block;
      width: 40px;
      min-width: 40px;
      height: 40px;
      background-color: #444;
      border-radius: 50%;
      margin-right: 5px;
    }
    #chat-list li .profile-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      color: #fff;
      font-weight: bold;
      font-size: 1.2em;
    }
    #chat-list li .name {
      font-weight: bold;
      display: inline-block;
      max-width: 100px;
    }
    #chat-list li .last-message {
      color: #888;
      font-size: 0.8em;
    }
    #chat-list li .message-count {
      color: #bbb;
      font-size: 0.9em;
      display: inline-block;
    }
    #chat-list li>span:nth-child(2) {
      display: flex;
      flex-direction: column;
      width: 100%;
    }
    #chat-list li>span>span {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;

    }
    .short-chat-details{
      color: #888;
      font-size: 0.8em;
      display: inline-block;
    }
    /* ---------------------------------- */
    .chat-container {
      display: flex;
      flex-direction: column;
      padding: 1rem;
      max-height: 80vh;
      overflow-y: auto;
    }

    .message {
      max-width: 60%;
      padding: 10px 14px;
      margin: 8px;
      border-radius: 12px;
      line-height: 1.4;
      font-size: 14px;
      position: relative;
    }

    .message.incoming {
      background-color: #2a2f38;
      color: white;
      align-self: flex-start;
      border-top-left-radius: 0;
    }

    .message.outgoing {
      background-color: #007aff;
      color: white;
      align-self: flex-end;
      border-top-right-radius: 0;
    }

    .message .timestamp {
      display: block;
      font-size: 11px;
      color: #aaa;
      margin-top: 4px;
      text-align: right;
    }
    /* ---------------------------------- */
    .userpic1 {
        background-color: #ff5555 !important;
    }
    .userpic2 {
        background-color: #64bf47 !important;
    }
    .userpic3 {
        background-color: #ffab00 !important;
    }
    .userpic4 {
        background-color: #4f9cd9 !important;
    }
    .userpic5 {
        background-color: #9884e8 !important;
    }
    .userpic6 {
        background-color: #e671a5 !important;
    }
    .userpic7 {
        background-color: #47bcd1 !important;
    }
    .userpic8 {
        background-color: #ff8c44 !important;
    }
  </style>
</head>
<body>
  <!-- Sidebar with directories -->
  <div id="sidebar" class="panel sidebar">
    <button onclick="togglePanel('sidebar')" class="toggle-btn"><<</button>
    <div class="hide-block">
      <!-- –ü–µ—Ä–µ–ª—ñ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ -->
      <div class="section">
        <h3>üìÅ –ö–∞—Ç–∞–ª–æ–≥–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å</h3>
        <ul id="folder-list" data-folder="{{selected_folder}}">
            {% for folder in folders %}
            <li onclick="selectFolder('{{folder}}')">üìÅ {{folder}}</li>
            {% endfor %}
        </ul>
      </div>
      <!-- –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ—ó —Å–µ—Å—ñ—ó -->
      <div id="statistics" class="section">
        <h3>üìä –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
        <p>Total contacts: <span id="totalContacts">0</span></p>
        <p>Personal chats: <span id="personalChats">0</span></p>
        <p>Public groups: <span id="publicGroups">0</span></p>
        <p>Public channels: <span id="publicChannels">0</span></p>
        <p>Private groups: <span id="privateGroups">0</span></p>
        <p>Private channels: <span id="privateCchannels">0</span></p>
      </div>
      <!-- –°–ø–∏—Å–æ–∫ —á–∞—Ç—ñ–≤ -->
      <div id="chat-list" class="section">
        <h3>üí¨ –ß–∞—Ç–∏</h3>
        <ul></ul>
      </div>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="content panel" id="content">
    <div class="toolbar">
      <h2>Telegram Export</h2>
      <div>
        <button onclick="toggleContacts()">üëÅ –ö–æ–Ω—Ç–∞–∫—Ç–∏</button>
        <button onclick="toggleChats()">üí¨ –ß–∞—Ç–∏</button>
      </div>
    </div>

    <div id="contacts" class="section">
      <h3>üë• –ö–æ–Ω—Ç–∞–∫—Ç–∏</h3>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>Name</th>
            <th>Phone</th>
            <th>Username</th>
            <th>User ID</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>

    <div id="chat-table" class="section">
      <h3>üí¨ –ß–∞—Ç–∏</h3>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>–ù–∞–∑–≤–∞</th>
            <th>ID</th>
            <th>–¢–∏–ø</th>
            <th>–û—Å—Ç–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –≤ —á–∞—Ç—ñ</th>
            <th>–í–º—ñ—Å—Ç —á–∞—Ç—É</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>

    <div id="chat-messages" class="section">
      <h3>üìú –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–∞—Ç—É</h3>
      <div id="messages-container" class="chat-container">
        <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥—É—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Ç—É—Ç -->
      </div>
      <div id="loading" style="display: none;">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å...</div>
      <div id="no-messages" style="display: none;">–ù–µ–º–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –¥–ª—è —Ü—å–æ–≥–æ —á–∞—Ç—É.</div>

    </div>
  </div>

  <!-- Right panel with chat details -->
  <div id="details" class="panel details">
    <button onclick="togglePanel('details')" class="toggle-btn">>></button>
    <div class="hide-block">
      <!-- –î–µ—Ç–∞–ª—ñ –æ–±—Ä–∞–Ω–æ–≥–æ —á–∞—Ç—É -->
      <div class="section">
        <h3>üìÑ –î–µ—Ç–∞–ª—ñ —á–∞—Ç—É</h3>
        <div id="chat-details">
          <div id="chatPhoto">
            <img id="chatAvatar" src="static/images/default-avatar.png" />
          </div>
          <div>
            <p><b>ID:</b> <span id="chatId">0</span></p>
            <p><b>–ù–∞–∑–≤–∞:</b> <span id="chatName">-</span></p>
            <p><b>–Æ–∑–µ—Ä–Ω–µ–π–º:</b> <span id="chatUsername">-</span></p>
            <p><b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> <span id="chatPhone">-</span></p>
            <p><b>–¢–∏–ø:</b> <span id="chatType">-</span></p>
            <p><b>–û—Å—Ç–∞–Ω–Ω—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:</b> <span id="chatDate">-</span></p>
            <p><b>–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:</b> <span id="chatSize">0</span></p>
            <h4>–ú–µ–¥—ñ–∞–≤–º—ñ—Å—Ç —á–∞—Ç—É:</h4>
            <p><b>–§–æ—Ç–æ:</b> <span id="chatPhotos">0</span></p>
            <p><b>–î–æ–∫—É–º–µ–Ω—Ç—ñ–≤:</b> <span id="chatDocuments">0</span></p>
            <p><b>–í—ñ–¥–µ–æ:</b> <span id="chatVideos">0</span></p>
            <p><b>–ê—É–¥—ñ–æ:</b> <span id="chatAudios">0</span></p>
            <p><b>–í—ñ–¥–µ–æ–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:</b> <span id="chatVMessages">0</span></p>
            <p><b>–ê—É–¥—ñ–æ–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:</b> <span id="chatAMessages">0</span></p>
          </div>
        </div>
      </div>
      
      <!-- –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤ -->
      <div id="contacts-list" class="section">
        <h3>üë• –ö–æ–Ω—Ç–∞–∫—Ç–∏</h3>
        <ul>

        </ul>
      </div>
    </div>
  </div>

  <script>
    function togglePanel(id) {
      const panel = document.getElementById(id);
      const hideBlock = panel.querySelector('.hide-block');
      panel.classList.toggle("collapsed");
      const isCollapsed = panel.classList.contains("collapsed");
      if (isCollapsed){
        hideBlock.style.display = "none";
      } else {
        setTimeout(() => {
          hideBlock.style.display = "block";
        }, 150);
      }
    }

    function toggleContacts() {
      document.getElementById("contacts").classList.toggle("hidden");
    }

    function toggleChats() {
      document.getElementById("chat-table").classList.toggle("hidden");
    }

    function selectFolder(folderName) {
      // alert("–í–∏–±—Ä–∞–Ω–æ –∫–∞—Ç–∞–ª–æ–≥: " + folderName);
    }

    function selectChat(chatId) {
      alert("–í–∏–±—Ä–∞–Ω–æ —á–∞—Ç: " + chatId);
    }
  </script>
  <script src="/static/export_view.js"></script>
</body>
</html>
